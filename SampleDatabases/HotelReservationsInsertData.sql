-- Creating test data
INSERT INTO Room (FloorNumber, RoomNumber, Occupancy, RoomType)
VALUES (1, 101, 4, 'Double'),
(1, 102, 2, 'King'),
(2, 201, 4, 'Double'),
(2, 202, 4, 'Double'),
(3, 301, 5, 'Suite');

INSERT INTO RoomRate (RoomID, StartDate, EndDate, Price)
VALUES (1, '2018/01/01', '2018/5/1', '99'),
(1, '2018/05/02', '2018/9/30', '149'),
(2, '2018/01/01', '2018/5/1', '89'),
(3, '2018/01/01', '2018/5/1', '79'),
(4, '2018/01/01', '2018/5/1', '169'),
(5, '2018/01/01', '2018/12/31', '210');

INSERT INTO Amenity (Type)
VALUES ('Spa Tub'),
('Ocean View'),
('Minibar'),
('Kitchen'),
('Living Room'),
('Fireplace');

INSERT INTO RoomAmenity (AmenityID, RoomID)
VALUES (3, 1),
(3, 2),
(2, 3),
(3, 4),
(4, 5),
(5, 5),
(6, 5);

INSERT INTO PromoRate (Type, Rate)
VALUES ('%', 20),
('%', 15),
('%', 10),
('$', 50),
('%', 8),
('$', 75);

INSERT INTO PromoType (PromoRateID, PromoCode, Description)
VALUES (1, 'MOM', 'Mother''s Day'),
(6, 'AAA', 'AAA Membership Discount'),
(3, 'CORP', 'Corporate Rate'),
(5, 'NOTAX', 'Tax Holiday');

INSERT INTO Promo (PromoTypeID, StartDate, EndDate)
VALUES (1, '2018/5/11', '2018/5/14'),
(1, '2017/5/10', '2017/5/14'),
(2, '2018/01/01', '2018/12/31'),
(3, '2018/1/1', '2018/12/31'),
(4, '2018/1/1', '2018/12/31');


INSERT INTO AddOn (Type)
VALUES ('Movie Rental'),
('Room Service - Breakfast'),
('Room Service - Dinner'),
('Room Service - Champagne'),
('Spa Massage');

INSERT INTO AddOnRate (AddOnId, StartDate, EndDate, Price)
VALUES (1, '2018/1/1', '2018/12/31', 5),
(2, '2018/1/1', '2018/12/31', 15),
(3, '2018/1/1', '2018/6/1', 50),
(3, '2018/6/2', '2018/12/31', 60),
(4, '2018/1/1', '2018/5/31', 30),
(4, '2018/6/1', '2018/12/31', 35),
(5, '2018/1/1', '2018/12/31', 90);

INSERT INTO Tax (Type, StartDate, EndDate, Rate)
VALUES ('WA Room Tax', '2017/1/20', null, 6.2),
('WA Meals Tax', '2018/1/1', null, 8.0);

INSERT INTO Person (FirstName, LastName, DateOfBirth, Phone, Email)
VALUES ('Jodie', 'Whittaker', '1985/2/27', '333-555-8888', 'doctor13@tardis.com'),
('Peter', 'Capaldi', '1955/2/27', '111-555-7777', 'doctor12@tardis.com'),
('Matt', 'Smith', '1988/2/27', '888-444-2222', 'doctor11@tardis.com'),
('David', 'Tennant', '1981/2/27', '666-222-0000', 'doctor10@tardis.com'),
('Christopher', 'Eccleston', '1966/2/27', '888-000-1111', 'doctor9@tardis.com'),
('Paul', 'McGann', '1958/2/27', '777-222-1111', 'doctor8@tardis.com'),
('Sylvester', 'McCoy', '1952/2/27', '666-444-2222', 'doctor7@tardis.com'),
('Colin', 'Baker', '1951/2/27', '111-000-2222', 'doctor6@tardis.com');

INSERT INTO Guest (PersonID)
VALUES (1),
(2),
(3),
(4),
(5),
(6),
(7),
(8);

INSERT INTO ReservationHolder (PersonID)
VALUES (1),
(3),
(4),
(6);

INSERT INTO Reservation (PromoID, ReservationHolderID, StartDate, EndDate)
VALUES (1, 1, '2018/5/12', '2018/5/14'),
(null, 1, '2018/3/17', '2018/3/20'),
(null, 2, '2018/4/12', '2018/4/17'),
(4, 3, '2018/10/1', '2018/10/6'),
(3, 4, '2018/6/14', '2018/6/21'),
(3, 3, '2018/9/12', '2018/9/15'),
(null, 4, '2018/9/12', '2018/9/20'),
(3, 4, '2018/7/23', '2018/8/1'),
(2, 2, '2018/11/1', '2018/11/5'),
(null, 3, '2018/12/2', '2018/12/6');

INSERT INTO GuestReservation (GuestID, ReservationID)
VALUES (1, 1),
(1, 2),
(2, 2),
(4, 2),
(2, 3),
(3, 3),
(5, 3),
(6, 3),
(7, 3),
(8, 3),
(1, 4),
(2, 4),
(3, 4),
(4, 4),
(5, 4),
(6, 4),
(7, 4),
(8, 4),
(6, 5),
(1, 6),
(4, 6),
(5, 7),
(6, 7),
(6, 8),
(1, 9),
(2, 9),
(3, 9),
(5, 9),
(6, 9),
(8, 9),
(4, 10),
(8, 10);

INSERT INTO ReservationRoom (ReservationID, RoomID)
VALUES (1, 2),
(2, 2),
(3, 2),
(3, 3),
(4, 3),
(4, 4),
(5, 2),
(6, 5),
(7, 2),
(8, 1),
(9, 1),
(9, 4),
(10, 5);

INSERT INTO Billing (ReservationID, Total)
VALUES (1, 586.72),
(2, 586.72),
(3, 586.72),
(4, 586.72),
(5, 586.72),
(6, 586.72),
(7, 586.72),
(8, 586.72),
(9, 586.72),
(10, 586.72);

INSERT INTO RoomBillDetail (TaxID, PromoID, RoomRateID, BillingID, TaxAmount, Price, TransactionDate)
VALUES(1, 1, 3, 1, 5.52, 89, '2018/5/12'),
(1, 1, 3, 1, 5.52, 89, '2018/5/13'),
(1, null, 3, 2, 5.52, 89, '2018/3/17'),
(1, null, 3, 2, 5.52, 89, '2018/3/18'),
(1, null, 3, 2, 5.52, 89, '2018/3/19'),
(1, null, 3, 3, 5.52, 89, '2018/4/12'),
(1, null, 3, 3, 5.52, 89, '2018/4/13'),
(1, null, 3, 3, 5.52, 89, '2018/4/14'),
(1, null, 3, 3, 5.52, 89, '2018/4/15'),
(1, null, 3, 3, 5.52, 89, '2018/4/16'),
(1, null, 4, 3, 4.90, 79, '2018/4/12'),
(1, null, 4, 3, 4.90, 79, '2018/4/13'),
(1, null, 4, 3, 4.90, 79, '2018/4/14'),
(1, null, 4, 3, 4.90, 79, '2018/4/15'),
(1, null, 4, 3, 4.90, 79, '2018/4/16'),
(1, 4, 4, 4, 4.90, 79, '2018/10/1'),
(1, 4, 4, 4, 4.90, 79, '2018/10/2'),
(1, 4, 4, 4, 4.90, 79, '2018/10/3'),
(1, 4, 4, 4, 4.90, 79, '2018/10/4'),
(1, 4, 4, 4, 4.90, 79, '2018/10/5'),
(1, 4, 5, 4, 10.48, 169, '2018/10/1'),
(1, 4, 5, 4, 10.48, 169, '2018/10/2'),
(1, 4, 5, 4, 10.48, 169, '2018/10/3'),
(1, 4, 5, 4, 10.48, 169, '2018/10/4'),
(1, 4, 5, 4, 10.48, 169, '2018/10/5'),
(1, 3, 3, 5, 5.52, 89, '2018/6/14'),
(1, 3, 3, 5, 5.52, 89, '2018/6/15'),
(1, 3, 3, 5, 5.52, 89, '2018/6/16'),
(1, 3, 3, 5, 5.52, 89, '2018/6/17'),
(1, 3, 3, 5, 5.52, 89, '2018/6/18'),
(1, 3, 3, 5, 5.52, 89, '2018/6/19'),
(1, 3, 3, 5, 5.52, 89, '2018/6/20'),
(1, 3, 6, 6, 13.02, 210, '2018/9/12'),
(1, 3, 6, 6, 13.02, 210, '2018/9/13'),
(1, 3, 6, 6, 13.02, 210, '2018/9/14'),
(1, null, 3, 7, 5.52, 89, '2018/9/12'),
(1, null, 3, 7, 5.52, 89, '2018/9/13'),
(1, null, 3, 7, 5.52, 89, '2018/9/14'),
(1, null, 3, 7, 5.52, 89, '2018/9/15'),
(1, null, 3, 7, 5.52, 89, '2018/9/16'),
(1, null, 3, 7, 5.52, 89, '2018/9/17'),
(1, null, 3, 7, 5.52, 89, '2018/9/18'),
(1, null, 3, 7, 5.52, 89, '2018/9/19'),
(1, 3, 1, 8, 6.14, 99, '2018/7/23'),
(1, 3, 1, 8, 6.14, 99, '2018/7/24'),
(1, 3, 1, 8, 6.14, 99, '2018/7/25'),
(1, 3, 1, 8, 6.14, 99, '2018/7/26'),
(1, 3, 1, 8, 6.14, 99, '2018/7/27'),
(1, 3, 1, 8, 6.14, 99, '2018/7/28'),
(1, 3, 1, 8, 6.14, 99, '2018/7/29'),
(1, 3, 1, 8, 6.14, 99, '2018/7/30'),
(1, 3, 1, 8, 6.14, 99, '2018/7/31'),
(1, 3, 2, 8, 9.24, 149, '2018/7/23'),
(1, 3, 2, 8, 9.24, 149, '2018/7/24'),
(1, 3, 2, 8, 9.24, 149, '2018/7/25'),
(1, 3, 2, 8, 9.24, 149, '2018/7/26'),
(1, 3, 2, 8, 9.24, 149, '2018/7/27'),
(1, 3, 2, 8, 9.24, 149, '2018/7/28'),
(1, 3, 2, 8, 9.24, 149, '2018/7/29'),
(1, 3, 2, 8, 9.24, 149, '2018/7/30'),
(1, 3, 2, 8, 9.24, 149, '2018/7/31'),
(1, 2, 2, 9, 9.24, 149, '2018/11/1'),
(1, 2, 2, 9, 9.24, 149, '2018/11/2'),
(1, 2, 2, 9, 9.24, 149, '2018/11/3'),
(1, 2, 2, 9, 9.24, 149, '2018/11/4'),
(1, 2, 5, 9, 9.24, 149, '2018/11/1'),
(1, 2, 5, 9, 9.24, 149, '2018/11/2'),
(1, 2, 5, 9, 9.24, 149, '2018/11/3'),
(1, 2, 5, 9, 9.24, 149, '2018/11/4'),
(1, 3, 6, 6, 13.02, 210, '2018/9/12'),
(1, 3, 6, 6, 13.02, 210, '2018/9/13'),
(1, 3, 6, 6, 13.02, 210, '2018/9/14'),
(1, null, 6, 10, 13.02, 210, '2018/12/2'),
(1, null, 6, 10, 13.02, 210, '2018/12/3'),
(1, null, 6, 10, 13.02, 210, '2018/12/4'),
(1, null, 6, 10, 13.02, 210, '2018/12/5');

INSERT INTO AddOnBillDetail (TaxID, PromoID, AddOnRateID, BillingID, TaxAmount, Price, TransactionDate)
VALUES
(2, 1, 2, 1, 1.20, 15, '2018/5/13'),
(2, 1, 2, 1, 9.20, 115, '2018/5/14'),
(2, 1, 2, 1, 4, 50, '2018/5/13'),
(2, 1, 3, 1, 4, 50, '2018/5/14'),
(2, 1, 7, 1, 4, 90, '2018/5/13'),
(2, 4, 2, 4, 1.20, 15, '2018/10/2'),
(2, 4, 2, 4, 1.20, 15, '2018/10/2'),
(2, 4, 2, 4, 1.20, 15, '2018/10/2'),
(2, 4, 2, 4, 1.20, 15, '2018/10/2'),
(2, 4, 2, 4, 1.20, 15, '2018/10/2'),
(2, 4, 2, 4, 1.20, 15, '2018/10/2'),
(2, 4, 2, 4, 1.20, 15, '2018/10/2'),
(2, 4, 2, 4, 1.20, 15, '2018/10/2'),
(2, 4, 2, 4, 1.20, 15, '2018/10/3'),
(2, 4, 2, 4, 1.20, 15, '2018/10/3'),
(2, 4, 2, 4, 1.20, 15, '2018/10/3'),
(2, 4, 2, 4, 1.20, 15, '2018/10/3'),
(2, 4, 2, 4, 1.20, 15, '2018/10/3'),
(2, 4, 2, 4, 1.20, 15, '2018/10/3'),
(2, 4, 2, 4, 1.20, 15, '2018/10/3'),
(2, 4, 2, 4, 1.20, 15, '2018/10/3'),
(2, 4, 2, 4, 1.20, 15, '2018/10/4'),
(2, 4, 2, 4, 1.20, 15, '2018/10/4'),
(2, 4, 2, 4, 1.20, 15, '2018/10/4'),
(2, 4, 2, 4, 1.20, 15, '2018/10/4'),
(2, 4, 2, 4, 1.20, 15, '2018/10/4'),
(2, 4, 2, 4, 1.20, 15, '2018/10/4'),
(2, 4, 2, 4, 1.20, 15, '2018/10/4'),
(2, 4, 2, 4, 1.20, 15, '2018/10/4'),
(2, 4, 2, 4, 1.20, 15, '2018/10/5'),
(2, 4, 2, 4, 1.20, 15, '2018/10/5'),
(2, 4, 2, 4, 1.20, 15, '2018/10/5'),
(2, 4, 2, 4, 1.20, 15, '2018/10/5'),
(2, 4, 2, 4, 1.20, 15, '2018/10/5'),
(2, 4, 2, 4, 1.20, 15, '2018/10/5'),
(2, 4, 2, 4, 1.20, 15, '2018/10/5'),
(2, 4, 2, 4, 1.20, 15, '2018/10/5'),
(2, 4, 2, 4, 1.20, 15, '2018/10/6'),
(2, 4, 2, 4, 1.20, 15, '2018/10/6'),
(2, 4, 2, 4, 1.20, 15, '2018/10/6'),
(2, 4, 2, 4, 1.20, 15, '2018/10/6'),
(2, 4, 2, 4, 1.20, 15, '2018/10/6'),
(2, 4, 2, 4, 1.20, 15, '2018/10/6'),
(2, 4, 2, 4, 1.20, 15, '2018/10/6'),
(2, 4, 2, 4, 1.20, 15, '2018/10/6'),
(2, 4, 4, 4, 4.80, 60, '2018/10/1'),
(2, 4, 4, 4, 4.80, 60, '2018/10/1'),
(2, 4, 4, 4, 4.80, 60, '2018/10/1'),
(2, 4, 4, 4, 4.80, 60, '2018/10/1'),
(2, 4, 4, 4, 4.80, 60, '2018/10/1'),
(2, 4, 4, 4, 4.80, 60, '2018/10/1'),
(2, 4, 4, 4, 4.80, 60, '2018/10/1'),
(2, 4, 4, 4, 4.80, 60, '2018/10/1'),
(2, 4, 4, 4, 4.80, 60, '2018/10/2'),
(2, 4, 4, 4, 4.80, 60, '2018/10/2'),
(2, 4, 4, 4, 4.80, 60, '2018/10/2'),
(2, 4, 4, 4, 4.80, 60, '2018/10/2'),
(2, 4, 4, 4, 4.80, 60, '2018/10/2'),
(2, 4, 4, 4, 4.80, 60, '2018/10/2'),
(2, 4, 4, 4, 4.80, 60, '2018/10/2'),
(2, 4, 4, 4, 4.80, 60, '2018/10/2'),
(2, 4, 4, 4, 4.80, 60, '2018/10/3'),
(2, 4, 4, 4, 4.80, 60, '2018/10/3'),
(2, 4, 4, 4, 4.80, 60, '2018/10/3'),
(2, 4, 4, 4, 4.80, 60, '2018/10/3'),
(2, 4, 4, 4, 4.80, 60, '2018/10/3'),
(2, 4, 4, 4, 4.80, 60, '2018/10/3'),
(2, 4, 4, 4, 4.80, 60, '2018/10/3'),
(2, 4, 4, 4, 4.80, 60, '2018/10/3'),
(2, 4, 4, 4, 4.80, 60, '2018/10/4'),
(2, 4, 4, 4, 4.80, 60, '2018/10/4'),
(2, 4, 4, 4, 4.80, 60, '2018/10/4'),
(2, 4, 4, 4, 4.80, 60, '2018/10/4'),
(2, 4, 4, 4, 4.80, 60, '2018/10/4'),
(2, 4, 4, 4, 4.80, 60, '2018/10/4'),
(2, 4, 4, 4, 4.80, 60, '2018/10/4'),
(2, 4, 4, 4, 4.80, 60, '2018/10/4'),
(2, 4, 4, 4, 4.80, 60, '2018/10/5'),
(2, 4, 4, 4, 4.80, 60, '2018/10/5'),
(2, 4, 4, 4, 4.80, 60, '2018/10/5'),
(2, 4, 4, 4, 4.80, 60, '2018/10/5'),
(2, 4, 4, 4, 4.80, 60, '2018/10/5'),
(2, 4, 4, 4, 4.80, 60, '2018/10/5'),
(2, 4, 4, 4, 4.80, 60, '2018/10/5'),
(2, 4, 4, 4, 4.80, 60, '2018/10/5'),
(2, 4, 1, 4, .80, 5, '2018/10/3'),
(2, 4, 1, 4, .80, 5, '2018/10/4'),
(2, 4, 7, 4, 7.20, 90, '2018/10/3'),
(2, 4, 7, 4, 7.20, 90, '2018/10/3'),
(2, 4, 7, 4, 7.20, 90, '2018/10/3'),
(2, 4, 7, 4, 7.20, 90, '2018/10/3'),
(2, 4, 7, 4, 7.20, 90, '2018/10/3'),
(2, null, 6, 7, 2.80, 35, '2018/9/18');

Update Billing
set Total =
(select (sum(AddOnBillDetail.Price) + 
	(select sum(RoomBillDetail.price) from RoomBillDetail where BillingID=4)) 
as TotalBill
from AddOnBillDetail
where BillingID=4)
where BillingID=4;

